<div class="dialog-wrapper">
  <div class="dialog-header">
    <h2 class="dialog-title">Chi tiết sản phẩm</h2>
    <button class="btn-close" (click)="close()">
      <i class="pi pi-times"></i>
    </button>
  </div>

  <div class="dialog-content">
    <div class="product-image-section" *ngIf="product.image">
      <img [src]="product.image" [alt]="product.name" (error)="onImageError($event)" />
    </div>

    <div class="info-grid">
      <div class="info-section">
        <h3 class="section-title">Thông tin cơ bản</h3>
        <div class="info-row">
          <span class="label">Tên sản phẩm</span>
          <span class="value">{{ product.name }}</span>
        </div>
        <div class="info-row">
          <span class="label">SKU</span>
          <span class="value code">{{ product.sku }}</span>
        </div>
        <div class="info-row">
          <span class="label">Barcode</span>
          <span class="value code">{{ product.bar_code || 'Không có' }}</span>
        </div>
        <div class="info-row">
          <span class="label">Phân loại</span>
          <span class="value">{{ product.name_category }}</span>
        </div>
        <div class="info-row">
          <span class="label">Đơn vị</span>
          <span class="value">{{ product.unit }}</span>
        </div>
      </div>

      <div class="info-section">
        <h3 class="section-title">Giá cả & Lợi nhuận</h3>
        <div class="info-row">
          <span class="label">Giá nhập</span>
          <span class="value">{{ product.cost_price | number : '1.0-0' }} đ</span>
        </div>
        <div class="info-row">
          <span class="label">Giá bán</span>
          <span class="value price">{{ product.price | number : '1.0-0' }} đ</span>
        </div>
        <div class="info-row">
          <span class="label">Lợi nhuận/sp</span>
          <span class="value profit">{{ profit | number : '1.0-0' }} đ</span>
        </div>
        <div class="info-row">
          <span class="label">Tỷ lệ lợi nhuận</span>
          <span class="value profit">{{ profitMargin }}%</span>
        </div>
      </div>

      <div class="info-section">
        <h3 class="section-title">Tồn kho</h3>
        <div class="info-row">
          <span class="label">Tồn kho hiện tại</span>
          <span
            class="value"
            [class.warning]="product.stock_quantity <= product.reorder_point"
            [class.danger]="product.stock_quantity === 0"
          >
            {{ product.stock_quantity }} {{ product.unit }}
          </span>
        </div>
        <div class="info-row">
          <span class="label">Điểm đặt lại</span>
          <span class="value">{{ product.reorder_point }} {{ product.unit }}</span>
        </div>
        <div class="info-row">
          <span class="label">Tồn kho tối đa</span>
          <span class="value">{{ product.max_stock_level }} {{ product.unit }}</span>
        </div>
        <div class="info-row">
          <span class="label">Trạng thái</span>
          <span class="status-badge" [class]="getStockStatusClass()">
            <i [class]="getStockStatusIcon()"></i>
            {{ getStockStatus() }}
          </span>
        </div>
      </div>

      <div class="info-section" *ngIf="product.primary_supplier_name">
        <h3 class="section-title">Nhà cung cấp</h3>
        <div class="info-row">
          <span class="label">Tên nhà cung cấp</span>
          <span class="value">{{ product.primary_supplier_name }}</span>
        </div>
        <div class="info-row" *ngIf="product.primary_supplier_cost">
          <span class="label">Giá nhập từ NCC</span>
          <span class="value">{{ product.primary_supplier_cost | number : '1.0-0' }} đ</span>
        </div>
      </div>

      <div class="info-section" *ngIf="product.has_expiry">
        <h3 class="section-title">Hạn sử dụng</h3>
        <div class="info-row">
          <span class="label">Có hạn sử dụng</span>
          <span class="value">Có</span>
        </div>
        <div class="info-row">
          <span class="label">Thời hạn sử dụng</span>
          <span class="value">{{ product.shelf_life_days }} ngày</span>
        </div>
      </div>

      <div class="info-section" *ngIf="product.description">
        <h3 class="section-title">Mô tả</h3>
        <p class="description">{{ product.description }}</p>
      </div>
    </div>
  </div>

  <div class="dialog-footer">
    <button class="btn-primary" (click)="close()">Đóng</button>
  </div>
</div>
