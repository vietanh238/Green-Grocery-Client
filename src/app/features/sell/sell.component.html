<div class="sell-container">
  <div class="search-section">
    <div class="search-row">
      <div class="search-input-wrapper">
        <i class="pi pi-search search-icon"></i>
        <input
          type="text"
          class="search-input"
          placeholder="Tìm kiếm sản phẩm theo tên, SKU, barcode..."
          (input)="filterProducts($event)"
          [(ngModel)]="keyFilter"
        />
      </div>
      <button class="scan-button" (click)="openScanner()">
        <i class="pi pi-camera"></i>
        Quét mã
      </button>
      <button class="manual-order-btn" (click)="addManualOrder()">
        <i class="pi pi-plus"></i>
        Thêm thủ công
      </button>
    </div>
  </div>

  <div class="main-content">
    <div class="products-section">
      <div class="products-header">
        <h3 class="products-title">
          <i class="pi pi-shopping-bag"></i>
          Sản phẩm
        </h3>
        <span class="products-count">{{ productsCount }} sản phẩm</span>
      </div>

      <div class="products-grid" *ngIf="!loading; else skeleton">
        <div *ngIf="isProductNotFound" class="product-not-found">
          <i class="pi pi-search" style="font-size: 2rem; margin-bottom: 1rem"></i>
          <p>Không tìm thấy sản phẩm phù hợp</p>
        </div>

        <app-card
          *ngFor="let product of products"
          [product]="product"
          (addToCart)="handleAddToCart($event)"
        >
        </app-card>
      </div>

      <ng-template #skeleton>
        <div class="skeleton-grid">
          <p-skeleton *ngFor="let i of [1, 2, 3, 4, 5, 6]" class="skeleton-card" />
        </div>
      </ng-template>
    </div>

    <div class="cart-section">
      <div class="cart-header">
        <h3 class="cart-title">
          <i class="pi pi-shopping-cart"></i>
          Giỏ hàng
        </h3>
        <span class="cart-count">{{ cartItemsCount }} sản phẩm</span>
      </div>

      <div class="cart-body">
        <div *ngIf="cartItems.length === 0" class="empty-cart">
          <i class="pi pi-shopping-cart"></i>
          <p>Giỏ hàng trống</p>
        </div>

        <div *ngIf="cartItems.length > 0" class="cart-items">
          <div *ngFor="let item of cartItems" class="cart-item">
            <div class="item-header">
              <h4 class="item-name">{{ item.name }}</h4>
              <span class="item-price">{{ formatCurrency(item.price) }}</span>
            </div>

            <div class="item-actions">
              <div class="quantity-controls">
                <button
                  class="quantity-btn"
                  (click)="decreaseQuantity(item)"
                  [disabled]="item.quantity <= 1"
                >
                  <i class="pi pi-minus"></i>
                </button>
                <span class="quantity-value">{{ item.quantity }}</span>
                <button class="quantity-btn" (click)="increaseQuantity(item)">
                  <i class="pi pi-plus"></i>
                </button>
              </div>

              <button class="delete-btn" (click)="removeItem(item)">
                <i class="pi pi-trash"></i>
              </button>
            </div>
          </div>
        </div>
      </div>

      <div *ngIf="cartItems.length > 0" class="cart-footer">
        <div class="total-section">
          <span class="total-label">Tổng cộng:</span>
          <span class="total-amount">{{ formatCurrency(totalAmount) }}</span>
        </div>

        <div class="payment-actions">
          <button class="payment-btn cash-btn" (click)="cashPayment()">
            <i class="pi pi-money-bill"></i>
            Thanh toán tiền mặt
          </button>

          <button class="payment-btn qr-btn" (click)="createPaymentQR()">
            <i class="pi pi-qrcode"></i>
            Tạo QR thanh toán
          </button>

          <button class="payment-btn clear-btn" (click)="clearCart()">
            <i class="pi pi-trash"></i>
            Xóa giỏ hàng
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
